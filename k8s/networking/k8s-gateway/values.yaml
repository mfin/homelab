app-template:
  controllers:
    main:
      replicas: 3
      strategy: RollingUpdate
      annotations:
        reloader.stakater.com/auto: "true"
      containers:
        main:
          image:
            repository: quay.io/oriedge/k8s_gateway
            tag: v0.3.4
          args: ["-conf", "/etc/coredns/Corefile"]
          probes:
            readiness:
              custom: true
              spec:
                httpGet:
                  path: /ready
                  port: 8181
            liveness:
              custom: true
              spec:
                httpGet:
                  path: /health
                  port: 8080
            startup:
              enabled: false
  service:
    main:
      type: LoadBalancer
      externalTrafficPolicy: Local
      ports:
        http:
          enabled: false
        metrics:
          enabled: true
          port: 9153
        dns:
          enabled: true
          port: 53
          targetPort: 1053
          protocol: UDP
  serviceMonitor:
    main:
      enabled: true
      endpoints:
        - port: metrics
          scheme: http
          path: /metrics
  serviceAccount:
    create: true
    name: k8s-gateway
  persistence:
    config:
      enabled: true
      type: configMap
      name: k8s-gateway-config
      globalMounts:
        - path: /etc/coredns/Corefile
          subPath: Corefile
          readOnly: true
