- name: Set logging
  community.general.ufw:
    logging: 'on'

- name: Allow SSH
  community.general.ufw:
    rule: allow
    name: SSH

- name: Allow DNS
  community.general.ufw:
    rule: allow
    name: DNS

- name: Allow WWW
  community.general.ufw:
    rule: allow
    name: WWW

- name: Allow wg-easy
  community.general.ufw:
    rule: allow
    port: 8082
    proto: tcp

- name: Allow CoreDNS metrics
  community.general.ufw:
    rule: allow
    port: 9153
    proto: tcp

- name: Allow node-exporter metrics
  community.general.ufw:
    rule: allow
    port: 9100
    proto: tcp

- name: Allow site-to-site route
  community.general.ufw:
    rule: allow
    route: true
    interface_in: eth0
    interface_out: wg0

- name: Allow outgoing
  community.general.ufw:
    state: enabled
    direction: outgoing
    policy: allow

- name: Deny incoming
  community.general.ufw:
    state: enabled
    direction: incoming
    policy: deny
