---
apiVersion: batch/v1
kind: Job
metadata:
  name: "${JOB_NAME}"
  namespace: "${NAMESPACE}"
spec:
  template:
    spec:
      containers:
      - envFrom:
        - secretRef:
            name: postgres
        - secretRef:
            name: minio
        env:
          - name: DUMP_FILE
            value: "${DUMP_FILE}"
        image: ghcr.io/mfin/postgres-minio-restore:rolling@sha256:f0e5e37e4e6f205879caa2ac3ee873a89f9ced5d6991b3fbc9475bf1ab4f8e6d
        imagePullPolicy: IfNotPresent
        name: pg-restore
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
      restartPolicy: Never
